<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Member Dashboard | Temp</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container">
    <a class="navbar-brand ms-auto fw" href="{{ url_for('main.home') }}">Temp</a>
    <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-light ms-3">Log Out</a>
  </div>
</nav>

<div class="container mt-4">
  <h1 class="mb-4">Welcome back, {{ user.first_name }}!</h1>

  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-3 mb-3">
      <div class="list-group">
        <a href="{{ url_for('member.dashboard') }}" class="list-group-item list-group-item-action active">Dashboard</a>
        <a href="{{ url_for('member.view_progress') }}" class="list-group-item list-group-item-action">View Progress</a>
        <a href="{{ url_for('member.exercise_plan') }}" class="list-group-item list-group-item-action">Exercise Plan</a>
      </div>
    </div>

    <!-- Main content -->
    <div class="col-md-9">
      <h3>Macronutrient Tracker</h3>
      
      <!-- Add Food Form -->
      <form method="POST" class="mb-4">
        <div class="input-group">
          <input type="text" name="food_search" class="form-control" placeholder="Search food..." value="{{ request.form.get('food_search', '') }}" required>
          <input type="number" step="0.01" name="quantity" class="form-control" placeholder="Quantity (grams)" required>
          <button type="submit" class="btn btn-primary">Add</button>
        </div>
      </form>

      <!-- Display Logged Foods -->
      {% if user_food_logs %}
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Food</th>
            <th>Quantity (g)</th>
            <th>Calories</th>
            <th>Protein</th>
            <th>Carbs</th>
            <th>Fat</th>
          </tr>
        </thead>
        <tbody>
          {% for log in user_food_logs %}
          <tr>
            <td>{{ log.food.name }}</td>
            <td>{{ log.quantity }}</td>
            <td>{{ (log.quantity / 100) * log.food.calories | round(1) }}</td>
            <td>{{ (log.quantity / 100) * log.food.protein | round(1) }}</td>
            <td>{{ (log.quantity / 100) * log.food.carbs | round(1) }}</td>
            <td>{{ (log.quantity / 100) * log.food.fat | round(1) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- Display Totals -->
      <div class="mt-3">
        <h5>Totals for today:</h5>
        <p>
          Calories: {{ totals.calories | round(1) }} kcal |
          Protein: {{ totals.protein | round(1) }} g |
          Carbs: {{ totals.carbs | round(1) }} g |
          Fat: {{ totals.fat | round(1) }} g
        </p>
      </div>
      {% else %}
      <p>No foods logged yet today.</p>
      {% endif %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
