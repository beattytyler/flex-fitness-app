<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Workout Session</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
  <style>
    body {
      background: linear-gradient(135deg, #eaf0ff, #fdfdff);
    }
    .section-card {
      background: linear-gradient(180deg, #ffffff 0%, #f7f9ff 100%);
      border-radius: 18px;
      padding: 1.75rem;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.08);
      border-top: 4px solid #4c8bf5;
      height: 100%;
    }
    .section-card.card-slate { border-top-color: #0a58ca; }
    .exercise-row + .exercise-row {
      border-top: 1px solid rgba(15, 23, 42, 0.08);
      margin-top: 1rem;
      padding-top: 1rem;
    }
    .history-label {
      text-transform: uppercase;
      font-size: 0.75rem;
      color: #94a3b8;
      letter-spacing: 0.08em;
    }
  </style>
</head>
<body class="app-shell" data-theme="{{ theme_mode or 'light' }}">
  <header class="app-top-bar mb-4">
    <div class="container d-flex align-items-center justify-content-between">
      <a class="app-brand" href="{{ url_for('main.home') }}"></a>
      <div class="app-actions">
        <button type="button" class="theme-toggle btn btn-sm btn-outline-light" aria-label="Toggle theme" aria-pressed="{{ 'true' if theme_mode == 'dark' else 'false' }}">
          <span class="theme-toggle-label">{{ 'Light mode' if theme_mode == 'dark' else 'Dark mode' }}</span>
        </button>
        {% if current_user.is_authenticated %}
          <span class="app-role-label">{{ current_user.role|capitalize }}</span>
        {% endif %}
        <a href="{{ url_for('auth.logout') }}" class="app-logout-link">Log out</a>
      </div>
    </div>
  </header>

  <div class="container pb-5">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3 mb-4">
      <div>
        <p class="text-muted mb-1">Workout Session</p>
        <h2 class="mb-1">{{ template_name }}</h2>
        <div class="text-muted small">{{ session_date_display }}</div>
      </div>
      <a href="{{ back_url }}" class="btn btn-link text-decoration-none">
        &larr; Back to {{ back_label }}
      </a>
    </div>

    <div class="row g-4">
      <div class="col-md-4">
        <div class="section-card">
          <h5 class="mb-3">Session Overview</h5>
          <div class="mb-3">
            <div class="history-label mb-1">Duration</div>
            <div class="fw-semibold">{{ duration_display }}</div>
          </div>
          <div class="mb-3">
            <div class="history-label mb-1">Total Volume</div>
            <div class="fw-semibold">{{ total_volume }} lbs</div>
          </div>
          <div>
            <div class="history-label mb-1">Logged Sets</div>
            <div class="fw-semibold">{{ exercise_details | sum(attribute='total_sets') }} total</div>
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <div class="section-card card-slate">
          <h5 class="mb-3">Exercises</h5>
          {% if exercise_details %}
            {% for exercise in exercise_details %}
              <div class="exercise-row">
                <div class="d-flex flex-column flex-sm-row justify-content-between gap-3">
                  <div>
                    <div class="history-label mb-1">Exercise</div>
                    <div class="fw-semibold">{{ exercise.name }}</div>
                  </div>
                  <div class="text-sm-end">
                    <div class="history-label mb-1">Best Set</div>
                    <div class="fw-semibold">
                      {% if exercise.best_weight is not none %}
                        {{ exercise.best_reps or 0 }} x {{ exercise.best_weight }} lbs
                      {% else %}
                        {{ exercise.best_reps or 0 }} x Bodyweight
                      {% endif %}
                    </div>
                  </div>
                </div>
                <div class="mt-3">
                  <div class="history-label mb-1">Logged Sets</div>
                  <div class="d-flex flex-wrap gap-3">
                    {% for s in exercise.sets %}
                      <span class="badge bg-light text-dark border">
                        Set {{ s.index }}: {{ s.reps or 0 }} x {% if s.weight is not none %}{{ s.weight }} lbs{% else %}Bodyweight{% endif %}
                      </span>
                    {% endfor %}
                  </div>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <p class="text-muted mb-0">No sets recorded for this workout.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  {% set member_calendar_active = (return_to == 'calendar') %}
  {% include '_bottom_nav.html' %}

  <script src="{{ url_for('static', filename='js/theme-toggle.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
